select cid, avg(indeg) follow_avg_indegree
  from
    (select m_community_id cid, follower_id, count(distinct(t.id)) indeg
    from vs_reporting.user_memberships u
    join
      (select follower_id, followable_id, max(id) id
      from `vs_reporting.follows_user`
      group by follower_id, followable_id) t on u.user_id = t.follower_id
    group by cid, follower_id)
  where cid is not null
  group by cid
