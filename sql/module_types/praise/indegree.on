select cid, avg(indeg) praise_avg_indegree
  from
    (select m_community_id cid, recipient_id, count(distinct(id)) indeg
    from vs_reporting.user_memberships u
    join
      (select recipient_id, sender_id, id
      from `vs_reporting.praises`) t on u.user_id = m.recipient_id
    group by cid, recipient_id)
  group by cid
